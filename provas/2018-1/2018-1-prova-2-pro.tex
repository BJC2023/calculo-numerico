\documentclass[12pt,a4paper]{article}
\usepackage{cmap} % Makes the PDF copiable. See http://tex.stackexchange.com/a/64198/25761
\usepackage[T1]{fontenc}
\usepackage[brazil]{babel}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{textcomp} % \degree
\usepackage{gensymb} % \degree
\usepackage[usenames,svgnames,dvipsnames]{xcolor}
\usepackage{hyperref}
\usepackage{multicol}
\usepackage{graphicx}
\usepackage[margin=2cm]{geometry}
\usepackage{systeme}
\usepackage{icomma}

\hypersetup{
    colorlinks = true,
    allcolors = {blue}
}

% TODO: Consider using exsheets
% http://linorg.usp.br/CTAN/macros/latex/contrib/exsheets/exsheets_en.pdf
%
% http://ctan.org/tex-archive/macros/latex/contrib/exercise/
% Options: answerdelayed,lastexercise,noanswer
\usepackage[answerdelayed,lastexercise]{exercise}

\addto\captionsbrazil{%
\def\listexercisename{Lista de exerc\'icios}%
\def\ExerciseName{Exerc\'icio}%
\def\AnswerName{Solu\c{c}\~ao do exerc\'icio}%
\def\ExerciseListName{Ex.}%
\def\AnswerListName{Solu\c{c}\~ao}%
\def\ExePartName{Parte}%
\def\ArticleOf{de\ }%
}

\renewcommand{\ExerciseHeaderTitle}{(\ExerciseTitle)\ }
\renewcommand{\ExerciseListHeader}{%\ExerciseHeaderDifficulty%
\textbf{%\ExerciseListName\
\ExerciseHeaderNB.\ %
%\ --- \
\ExerciseHeaderTitle}%
%\ExerciseHeaderOrigin
\ignorespaces}
\renewcommand{\AnswerListHeader}{\textbf{\ExerciseHeaderNB.\ (\AnswerListName)\ }}

\newcommand*\R{\mathbb{R}}

\renewcommand{\theenumi}{\alph{enumi}}
\renewcommand\labelenumi{(\theenumi) }

\newcommand*\tipo{Prova II}
\newcommand*\turma{PRO112-04U}
\newcommand*\disciplina{CAN0001}
\newcommand*\eu{Helder G. G. de Lima}
\newcommand*\data{22/05/2018}

\author{\eu}
\title{\tipo - \disciplina}
\date{\data}

\begin{document}
\thispagestyle{empty}
\newgeometry{margin=2cm,bottom=0.5cm}
\begin{center}
\includegraphics[width=9.0cm]{marca} \\
\textbf{\tipo\ (\disciplina / \turma)} \\
Prof. \eu\footnote{
Este é um material de acesso livre distribuído sob os termos da licença \href{https://creativecommons.org/licenses/by-sa/4.0/deed.pt_BR}{Creative Commons BY-SA 4.0}}
\end{center}

\noindent Nome do(a) aluno(a): \underline{\hspace{9,7cm}} Data: \underline{\data}

%\section*{Instruções}
\begin{center}\fbox{
\begin{minipage}{14cm}

{\footnotesize
\begin{itemize}
\renewcommand{\theenumi}{\Roman{enumi}}
\item Identifique-se em todas as folhas.
\item Mantenha o celular e os demais equipamentos eletrônicos desligados durante a prova.
\item Justifique cada resposta com cálculos ou argumentos baseados na teoria estudada.
\item Sempre que calcular o valor de uma das funções consideradas em um ponto $x$, arredonde o resultado para o número de dígitos especificado, e só então use esse valor (arredondado) nas fórmulas dos métodos iterativos.
\item Resolva apenas os itens de que precisar para somar 10,0 pontos.
\end{itemize}
}

\end{minipage}
}
\end{center}

%\section*{Questões}
\begin{ExerciseList}
\Exercise[title={4,0}]
Mostre que os métodos de Jacobi e de Gauss-Seidel convergirão, se forem aplicados a:
\[
\begin{cases}
4x_1-3x_2\phantom{+ 0 x_3 } &= 3\\
3x_1-9x_2+\phantom{1}x_3 &= 14\\
2x_1+2x_2+5x_3 &= 15.
\end{cases}
\]
Considere $X^{(0)} = (0,000, 1,000, 2,000)$ e mostre que o erro relativo da aproximação $X^{(3)}$ obtida por Jacobi é o dobro do erro relativo da aproximação $X^{(3)}$ obtida por Gauss-Seidel.
\\
(arredonde cada resultado com \textbf{3 dígitos} após a vírgula)
\Answer A matriz de coeficientes do sistema linear em questão é  estritamente diagonal dominante, pois $| 4| > |-3| + |0|$, $|-9| > | 3| + |1|$ e $| 5| > | 2| + |2|$. Então, por este critério, é garantido que os métodos iterativos produzirão sequências convergentes. As equações utilizadas em cada um dos métodos iterativos são as seguintes:

\medskip
\begin{center}
\begin{tabular}{ll}
\textbf{Método de Jacobi}
&
\textbf{Método de Gauss-Seidel}\\
$
\begin{cases}
x_1^{(k)} = (3 + 3x_2^{(k-1)})/4\\
x_2^{(k)} = (-14 + 3x_1^{ \boldsymbol{(k-1)} } + x_3^{(k-1)})/9\\
x_3^{(k)} = (15 - 2x_1^{ \boldsymbol{(k-1)} } - 2x_2^{ \boldsymbol{(k-1)} })/5,
\end{cases}
$
&
$
\begin{cases}
x_1^{(k)} = (3 + 3x_2^{(k-1)})/4\\
x_2^{(k)} = (-14 + 3x_1^{ \boldsymbol{(k)} } + x_3^{(k-1)})/9\\
x_3^{(k)} = (15 - 2x_1^{ \boldsymbol{(k)} } - 2x_2^{ \boldsymbol{(k)} })/5,
\end{cases}
$\\
\end{tabular}
\end{center}
\medskip
Observe que no método de Gauss-Seidel, os valores de $x_j^{(k)}$ são utilizados em vez de $x_j^{(k-1)}$ assim que estão disponíveis. Consequentemente, os valores obtidos a cada iteração são os seguintes:
\medskip
\begin{center}
\begin{tabular}{cc}
\textbf{Método de Jacobi}
&
\textbf{Método de Gauss-Seidel}\\
\begin{tabular}{|c|r|r|r|r|}
\hline
$\boldsymbol{k}$         & 0 & 1 & 2 & 3 \\
\hline
$\boldsymbol{x_1^{(k)}}$ & 0,000 &  1,500 & -0,250 &  0,175\\
\hline
$\boldsymbol{x_2^{(k)}}$ & 1,000 & -1,333 & -0,767 & -1,313\\
\hline
$\boldsymbol{x_3^{(k)}}$ & 2,000 &  2,600 &  2,933 &  3,407\\
\hline
\end{tabular}
&
\begin{tabular}{|c|r|r|r|r|}
\hline
$\boldsymbol{k}$     & 0 & 1 & 2 & 3 \\
\hline
$\boldsymbol{x_1^{(k)}}$ & 0,000 & 1,500 & 0,125 & -0,158\\
\hline
$\boldsymbol{x_2^{(k)}}$ & 1,000 & -0,833 & -1,210 & -1,227\\
\hline
$\boldsymbol{x_3^{(k)}}$ & 2,000 & 2,733 & 3,434 & 3,554\\
\hline
\end{tabular}\\
\end{tabular}
\end{center}
\medskip
Na terceira iteração, obtêm-se as seguintes estimativas para os erros cometidos:
\medskip
\begin{center}
\begin{tabular}{|c|p{7.1cm}|p{7.1cm}|}
\hline
\textbf{Erro}
&
\textbf{Método de Jacobi}
&
\textbf{Método de Gauss-Seidel}\\\hline
Absoluto
&
$\begin{array}{lll}
       & ||X^{(3)} - X^{(2)}|| \\
= \max & \left\{\right. |0,175-(-0,250)|, \\
       & \quad |-1,313-(-0,767)|, \\
       & \quad |3,407 - 2,933| \left.\right\} \\
= \max & \left\{ |0,425|, |-0,546|, |0,474| \right\} \\
= 0,546\hspace{-1cm} &
\end{array}$
&
$\begin{array}{lll}
       & ||X^{(3)} - X^{(2)}|| \\
= \max & \left\{\right. |0.8335-0.8300|, \\
       & \quad |-1,227-(-1,210)|, \\
       & \quad |3,554-3,434| \left.\right\} \\
= \max & \left\{ |-0,283|, |-0,017|, |0,120| \right\} \\
= 0,283\hspace{-1cm} &
\end{array}$
\\\hline
Relativo
&
$0,546/3,407 = 0,160$
&
$0,283/3,554 = 0,080$
\\\hline
\end{tabular}
\end{center}

Assim, o erro relativo da aproximação $X^{(3)} = (0,175, -1,313, 3,407)$ obtida por Jacobi é o dobro do erro relativo da aproximação $X^{(3)} = (-0,158, -1,227, 3,554)$ obtida por Gauss-Seidel.

\Exercise[title={2,0}]
Considere os seguintes sistemas lineares:
\[
(1)
\systeme{
x-3y+z=0,
-3x+10y=-3,
x+11z=10
}
\qquad
(2)
\systeme{
x-3y+z=-3,
-3x+10y=8,
x+11z=7
}
\]
\begin{enumerate}
\item Obtenha a decomposição $A = L \cdot U$ para a matriz de coeficientes destes sistemas
\item Utilize a decomposição anterior para resolver os sistemas dados.\vspace{-0.6cm}
\end{enumerate}
\Answer
Se forem realizadas as operações elementares $L_2 \to L_2 + 3L_1$, $L_3 \to L_3 - L_1$ e $L_3 \to L_3 - 3L_2$ à matriz de coeficientes dos sistemas, $A=
\begin{bmatrix}
 1 & -3 &  1\\
-3 & 10 &  0\\
 1 &  0 & 11
\end{bmatrix}$, será obtida a decomposição $A = L U$, em que:
\[
L=
\begin{bmatrix}
 1 & 0 &  0\\
-3 & 1 &  0\\
 1 & 3 &  1
\end{bmatrix}
\text{ e }
U =\begin{bmatrix}
1 & -3 & 1\\
0 &  1 & 3\\
0 &  0 & 1
\end{bmatrix} (= L^T).
\]
Esta fatoração pode ser utilizada para calcular as soluções de ambos os sistemas. Para isso, resolve-se primeiramente um sistema $LY=B$ e com a solução $Y$ obtida resolve-se $UX = Y$. Os resultados em cada caso serão os seguintes:
\begin{multicols}{2}
\begin{enumerate}
\item
$
 Y  =
\begin{bmatrix}
0 \\ -3 \\ 19
\end{bmatrix}
\text{ e }
X =\begin{bmatrix}
-199 \\ -60 \\ 19
\end{bmatrix}
$
\item
$
 Y  =
\begin{bmatrix}
-3 \\ -1\\ 13
\end{bmatrix}
\text{ e }
 X  =
\begin{bmatrix}
-136 \\ -40 \\ 13
\end{bmatrix}$
\end{enumerate}
\end{multicols}
\Exercise[title={2,0}]
Para quais valores de $k \in \R$ a matriz do sistema linear $
\systeme{
k x + 2y=6,
k x - 4y=8
}$
é estritamente diagonalmente dominante? Considere o maior valor inteiro de $k$ satisfazendo a condição anterior e obtenha a solução aproximada do sistema correspondente, com erro relativo menor ou igual a $0,1$, usando o método de Jacobi.
\Answer Para que a matriz do sistema linear seja estritamente diagonalmente dominante, $k$ deve ser tal que $|k| > |2|$ e $|-4| > |k|$, isto é, $k \in (-4, -2) \cup (2, 4)$. O maior valor inteiro nestas condições é $k = 3$. Neste caso, o sistema a ser resolvido é
$
\systeme{
3 x + 2y=6,
3 x - 4y=8
}$
e o método de Jacobi utilizará as equações
\[
\begin{cases}
x^{k} = (6-2y^{k-1})/3,\\
x^{k} = (-8+3x^{k-1})/4
\end{cases}
\]
Como a matriz do sistema é estritamente diagonalmente dominante, qualquer aproximação inicial produzirá uma sequência convergente. Considerando, por exemplo, $(x^{(0)}, y^{(0)}) = (3, -1)$, as iterações serão as seguintes:
\medskip
\begin{center}
\begin{tabular}{|c|r|r|r|r|r|r|r|r|r|r|r|r|r|}
\hline
$\boldsymbol{k}$         & 0 & 1 & 2 & 3 & 4 & 5 & 6\\
\hline
$\boldsymbol{x^{(k)}}$ & 3,000 & 2,667 & 1,833 & 2,000 & 2,417 & 2,333 & 2,125 \\
\hline
$\boldsymbol{y^{(k)}}$ & -1,000 & 0,250 & 0,000 & -0,625 & -0,500 & -0,187 & -0,250 \\
\hline
$\boldsymbol{\varepsilon_{rel}}$ & - & 0,469 & 0,455 & 0,313 & 0,173 & 0,134 & \textbf{0,098}\\
\hline
\end{tabular}
\end{center}
\medskip
Portanto, $(x^{(6)}, y^{(6)}) = (2,125, -0,250)$ é uma solução aproximada do sistema, com um erro relativo de cerca de $0,1$.

\Exercise[title={2,0}]
Em uma pesquisa recente foi constatado que o preço de um \textit{pendrive} varia em função de sua capacidade em gigabytes, conforme a tabela a seguir:
\medskip
\begin{center}
\begin{tabular}{|c|c|c|c|c|}
\hline
Tamanho (GB) & 4 & 8 & 32 & 64 \\
\hline
Preço (R\$) & 20 & 25 & 40 & 80 \\
\hline
\end{tabular}
\end{center}\medskip
Estime o preço de um \textit{pendrive} de 16GB usando o polinômio interpolador obtido por diferenças divididas (forma de Newton).
\Answer A partir dos pontos dados, obtém-se:
\[
	\begin{array}{cccccc}
   x_i & y_i=f[x_i] & f[x_i,x_{i+1}] & f[x_i,x_{i+1},x_{i+2}]  & f[x_i,x_{i+1},x_{i+2},x_{i+3}] \\
   4,0000 & \mathbf{20,0000} \\
	    &            & \mathbf{1,2500} \\
   8,0000 & 25,0000 &             & \mathbf{-0,0223}\\
	    &            & 0,6250 &              & \mathbf{0,0006}. \\
  32,0000 & 40,0000 &             & 0.0112\\
	    &            & 1,2500 \\
  64,0000 & 80,0000
	\end{array}
\]

Então:
\begin{align*}
p(x)
&=20
 +1,25(x-4)
 -0,0223(x-4)(x-8)
 +0,0006(x-4)(x-8)(x-32)\\
& = 0,0006x^3 - 0,0469x^2 + 1,75x + 13,7143.
\end{align*}
Usando este polinômio para estimar o valor pedido, resulta que o preço é aproximadamente:
\begin{align*}
\approx p(16)
& =-1,5708\\
& \quad +1,2500\cdot(12)\\
& \quad -0,0223\cdot(12)\cdot(8)\\
& \quad +0,0006\cdot(12)\cdot(8)\cdot(-16)\\
& \approx 32.
\end{align*}

\Exercise[title={2,0}]
Obtenha, pelo método de Lagrange, o polinômio $p(x)$ que interpola $f(x) = x^5 - x + 1$ em $x_0 = -1$, $x_1 = 0$ e $x_2 = 1$. Utilize as derivadas de ordem superior de $f$ para estimar o erro absoluto máximo que ocorre ao aproximar $f(x)$ por $p(x)$ conforme $x$ varia no intervalo $[-1, 1]$.
\Answer Considerando que $f(-1) = 1$, $f(0) = 1$ e $f(1) = 1$, o método de Lagrange permite que o polinômio que interpola $f$ nestes pontos seja descrito da seguinte forma:
\begin{align*}
p(x)
& = 1 L_0(x) + 1 L_1(x) + 1 L_2(x) \\
& = 1 \cdot \frac{x(x-1)}{-1(-1-1)}
  + 1 \cdot \frac{(x+1)(x-1)}{(0+1)(0-1)}
  + 1 \cdot \frac{(x+1)x}{(1+1)1}\\
& = \frac{x^2-x}{2}
    + (1-x^2)
    + \frac{x^2+x}{2} = 1.
\end{align*}
Logo,
\[
f(x) = 1 + \frac{f^{(3)}(\xi(x))}{3!}(x+1)x(x-1).
\]
Como $f^\prime(x) = 5x^4-1$, $f^{\prime\prime}(x) = 20x^3$ e $f^{(3)}(x) = 60x^2$, tem-se em particular que
\[
\varepsilon_{abs}(x)
= \left|f(x) - 1\right|
\leq \frac{M}{3!} \left|(x+1)x(x-1)\right|,
\]
em que $M
= \max_{x \in [-1,1]} \left|f^{(3)}(x)\right|
= \max_{x \in [-1,1]} \left|60x^2\right|
= 60$. Além disso, se $q(x) = (x+1)x(x-1) = x^3-x$ então $q^\prime(x) = 3x^2-1 = 0$ se, e somente se, $x = \pm\frac{\sqrt{3}}{3}$, o que significa que os valores máximo e mínimo de $q(x)$ em $[-1,1]$ ocorrem em um dos pontos $\{ \pm1, \pm\frac{\sqrt{3}}{3} \}$. Como $q(\pm1) = 0$, $q(\pm\frac{\sqrt{3}}{3}) \approx \mp0,3849$ e $q^{\prime\prime}(\pm\frac{\sqrt{3}}{3}) \pm 2\sqrt{3}$, conclui-se que $-\frac{\sqrt{3}}{3}$ é um ponto de máximo, $\frac{\sqrt{3}}{3}$ é um ponto de mínimo, e o valor máximo de $|q(x)|$ é $0,3849$. Portanto,
\[
\varepsilon_{abs}(x)
\leq \frac{60}{6} \left|x^3 - x\right|
\leq 10 \cdot \max_{x \in [-1,1]} \left|x^3 - x\right|
= 10 \cdot 0,3849
= 3,849.
\]
\end{ExerciseList}

\begin{center}
BOA PROVA!
\end{center}

\newpage
\restoregeometry
\section*{Respostas}
\shipoutAnswer
\end{document}
