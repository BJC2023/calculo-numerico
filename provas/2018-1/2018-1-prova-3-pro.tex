\documentclass[12pt,a4paper]{article}
\usepackage{cmap} % Makes the PDF copiable. See http://tex.stackexchange.com/a/64198/25761
\usepackage[T1]{fontenc}
\usepackage[brazil]{babel}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{textcomp} % \degree
\usepackage{gensymb} % \degree
\usepackage[usenames,svgnames,dvipsnames]{xcolor}
\usepackage{hyperref}
\usepackage{multicol}
\usepackage{graphicx}
\usepackage[margin=2cm]{geometry}
\usepackage{systeme}
\usepackage{icomma}

\hypersetup{
    colorlinks = true,
    allcolors = {blue}
}

% TODO: Consider using exsheets
% http://linorg.usp.br/CTAN/macros/latex/contrib/exsheets/exsheets_en.pdf
%
% http://ctan.org/tex-archive/macros/latex/contrib/exercise/
% Options: answerdelayed,lastexercise,noanswer
\usepackage[answerdelayed,lastexercise]{exercise}

\addto\captionsbrazil{%
\def\listexercisename{Lista de exerc\'icios}%
\def\ExerciseName{Exerc\'icio}%
\def\AnswerName{Solu\c{c}\~ao do exerc\'icio}%
\def\ExerciseListName{Ex.}%
\def\AnswerListName{Solu\c{c}\~ao}%
\def\ExePartName{Parte}%
\def\ArticleOf{de\ }%
}

\renewcommand{\ExerciseHeaderTitle}{(\ExerciseTitle)\ }
\renewcommand{\ExerciseListHeader}{%\ExerciseHeaderDifficulty%
\textbf{%\ExerciseListName\
\ExerciseHeaderNB.\ %
%\ --- \ 
\ExerciseHeaderTitle}%
%\ExerciseHeaderOrigin
\ignorespaces}
\renewcommand{\AnswerListHeader}{\textbf{\ExerciseHeaderNB.\ (\AnswerListName)\ }}

\renewcommand{\theenumi}{\alph{enumi}}
\renewcommand\labelenumi{(\theenumi) }

\newcommand*\tipo{Prova III}
\newcommand*\turma{PRO112-04U}
\newcommand*\disciplina{CAN0001}
\newcommand*\eu{Helder G. G. de Lima}
\newcommand*\data{03/07/2018}

\author{\eu}
\title{\tipo - \disciplina}
\date{\data}

\begin{document}
\thispagestyle{empty}
\newgeometry{margin=2cm,bottom=0.5cm}
\begin{center}
\includegraphics[width=9.0cm]{marca} \\
\textbf{\tipo\ (\disciplina / \turma)} \\
Prof. \eu\footnote{
Este é um material de acesso livre distribuído sob os termos da licença \href{https://creativecommons.org/licenses/by-sa/4.0/deed.pt_BR}{Creative Commons BY-SA 4.0}}
\end{center}

\noindent Nome do(a) aluno(a): \underline{\hspace{9,7cm}} Data: \underline{\data}

%\section*{Instruções}
\begin{center}\fbox{
\begin{minipage}{14cm}

{\footnotesize
\begin{itemize}
\renewcommand{\theenumi}{\Roman{enumi}}
\item Identifique-se em todas as folhas.
\item Mantenha o celular e os demais equipamentos eletrônicos desligados durante a prova.
\item Justifique cada resposta com cálculos ou argumentos baseados na teoria estudada.
\item Sempre que calcular o valor de uma das funções consideradas em um ponto $x$, arredonde o resultado para o número de dígitos especificado, e só então use esse valor (arredondado) nas fórmulas dos métodos iterativos.
\item Resolva apenas os itens de que precisar para somar 10,0 pontos.
\end{itemize}
}

\end{minipage}
}
\end{center}

%\section*{Questões}
\begin{ExerciseList}
\Exercise[title={1,0}]
Explique o funcionamento e as vantagens do método de Newton-Cotes adaptável.
\Answer Neste método, depois de aproximar o valor de $\int_a^b f(x)\,dx$, é feita uma estimativa do erro cometido nesta aproximação. Se o erro é maior do que o desejado, o intervalo é subdividido ao meio, e são calculadas aproximações individuais para $\int_a^{\frac{a+b}{2}} f(x)\,dx$ e $\int_{\frac{a+b}{2}}^b f(x)\,dx$. Em cada caso, o erro cometido é avaliado, e usado como critério para decidir se algum dos intervalos (ou ambos) precisa ser dividido ao meio novamente. O processo se repete até que a soma das aproximações das integrais nos subintervalos considerados esteja próxima o bastante do valor exato da integral em $[a,b]$. Uma vantagem deste tipo de abordagem é que ele evita calcular $f(x)$ desnecessariamente em regiões onde é possível alcançar uma boa aproximação sem usar muitos pontos.

\Exercise[title={3,0}] Aplique o método de Romberg para obter uma aproximação $\displaystyle R_{k,k} \approx \int_{1}^{9} \frac{1}{x}\, dx = \ln(9)$, com um erro absoluto de no máximo $0,01$, avaliando a função $f(x) = 1/x$ no mínimo de pontos possível. Organize as aproximações $R_{k,j}$ calculadas em uma tabela.

{\color{blue} \textit{(Utilize números decimais com 4 dígitos após a vírgula)}}
\Answer Para que a aproximação $R_{k,k}$ tenha um erro absoluto de no máximo $0,01\%$ em relação ao valor exato $I = \ln(9)$, ela deve estar no intervalo $(\ln(9)-0,01, \ln(9)+0,01) \approx (2,1872, 2,2072)$. Calculando os termos $R_{k,j}$, obtêm-se:
\begin{multicols}{2}
\begin{itemize}
\item $R_{1,1}
= \frac{8}{2}(1 + \frac{1}{9})
= 4,4444$
\item $R_{2,1}
= \frac{8}{4}(1 + 2\cdot\frac{1}{5} + \frac{1}{9})
= 3,0222$
\item $R_{2,2}
= 3,0222+\frac{3,0222 - 4,4444}{3}
= 2,5481$
\item $R_{3,1}
= \frac{8}{8}(1 + 2\cdot(\frac{1}{3}+\frac{1}{5}+\frac{1}{7}) + \frac{1}{9})\\
= 2,4635$
\item $R_{3,2}
= 2,4635+\frac{2,4635-3,0222}{3}
= 2,2773$
\item $R_{3,3}
= 2,2773+\frac{2,2773-2,5481}{15}
= 2,2592$
\item $R_{4,1}
= \frac{8}{16}(1 + 2\cdot(\frac{1}{2}+\frac{1}{3}+\frac{1}{4}+\frac{1}{5}+\frac{1}{6}+\frac{1}{7}+\frac{1}{8}) + \frac{1}{9})\\
= 2,2734$
\item $R_{4,2}
= 2,2734+\frac{2,2734-2,4635}{3}
= 2,2100$
\item $R_{4,3}
= 2,2100+\frac{2,2100-2,2773}{15}
= \textbf{2,2055}$
\item $R_{4,4}
= 2,2055+\frac{2,2055-2,2592}{63}
= \textbf{2,2046}$
\end{itemize}
\end{multicols}

Os resultados anteriores são resumidos na tabela a seguir, juntamente com os erros absolutos correspondentes aos termos $R_{k,k}$:
\begin{center}
\begin{tabular}{|c|c|c|c|c|r|}
\hline 
$\mathbf{k}$ & $\mathbf{ R_{k,1} }$ & $\mathbf{ R_{k,2} }$ & $\mathbf{ R_{k,3} }$ & $\mathbf{ R_{k,4} }$ & \textbf{Erro} \\ 
\hline 
1& \textbf{4,4444} &  &  &  & 2,2472 \\ 
\hline 
2& 3,0222 & \textbf{2,5481} & & & 0,3509 \\ 
\hline 
3& 2,4635 & 2,2773 & \textbf{2,2592} & & 0,0620 \\ 
\hline 
4& 2,2734 & 2,2100 & 2,2055 & \textbf{2,2046} & \textbf{0,0074} \\ 
\hline 
\end{tabular}
\end{center}

\Exercise[title={3,0}] Sabendo que
$I = \int_{1}^{13} \ln(x) \, dx
= 13\ln(13) - 12
\approx 21,3443$,
mostre que o erro relativo percentual da aproximação de $I$ pela regra de Gauss-Legendre com 4 pontos é inferior a $0,1\%$.

{\color{blue} \textit{(Utilize números decimais com 4 dígitos após a vírgula)}}
\Answer
Fazendo a mudança de variáveis $x = 6t + 7$, tem-se $dx = 6 dt$ e
$\int_1^{13} \ln(x)\,dx = 6\int_{-1}^1 \ln(6t + 7)\,dt$.
Assim, pode-se aplicar o método de Gauss-Legendre, arredondando todos os valores relevantes com 4 dígitos após a vírgula, para obter:
\begin{align*}
I & \approx
6 \cdot (  0,347\textbf{9} \cdot \ln(6(-0,8611) + 7) \\
& + 0,6521          \cdot \ln(6(-0,3\textbf{400}) + 7)\\
& + 0,6521          \cdot \ln(6( 0,3\textbf{400}) + 7)\\
& + 0,347\textbf{9} \cdot \ln(6(-0,8611) + 7) )\\
& = 
6(0,3479 \cdot 0,6061
+ 0,6521 \cdot 1,6014
+ 0,6521 \cdot 2,2016
+ 0,3479 \cdot 2,4987)\\
& = 6( 0,2108 + 1,0444 + 1,4358 + 0,8692 ) = 21,361
\end{align*}

Assim, $\varepsilon_{abs} = \frac{|21,361 - 21,3443| }{ |21,3443| }\times 100\%
 = \frac{ |0,0167| }{ |21,3443| } \times 100\%
 = 0,0782 \% < 0,1\%$.

\Exercise[title={3,0}] 
Considere uma função $g$ que assume os valores dados na tabela a seguir:
%g(x) = ln(x)
\medskip
\begin{center}
\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|}
\hline
   $x_i$ & 1    & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 & 10 & 11 & 12 & 13 \\ \hline
$g(x_i)$ & 0,00 & 0,69 & 1,10 & 1,39 & 1,61 & 1,79 & 1,95 & 2,08 & 2,20 & 2,30 & 2,40 & 2,48 & 2,56 \\ \hline
\end{tabular}
\end{center}
\medskip
Estime $\int_1^{13} g(x)\,dx$ utilizando a regra 1/3 de Simpson composta no maior número de subintervalos de mesmo comprimento que for possível.

{\color{blue} \textit{(Utilize números decimais com 2 dígitos após a vírgula)}}
\Answer A integral pode ser aproximada considerando $h = \frac{13-1}{12} = 1$ e
\[
I = 
\int_1^{13} g(x)\,dx
\approx \frac{h}{3} \sum_{i=0}^{12} c_ig(x_i),
\text{ em que }
c_i =
\begin{cases}
1 & \text{ se } i = 0 \text{ ou } i = 12\\
4 & \text{ se } i \text{ é ímpar}\\
2 & \text{ se } i \text{ é par}.
\end{cases}
\]
Isso permite que os cálculos sejam facilitados com o auxílio da seguinte tabela:

\medskip
\begin{center}
\begin{tabular}{|c|c|c|c|c|}
\hline 
$i$ & $x_i$ & $g(x_i)$ & $c_i$ & $c_i \cdot g(x_i)$ \\ 
\hline \hline 
0  &  1 & 0,00 & 1 & 0,00 \\ 
\hline 
1  &  2 & 0,69 & 4 & 2,76 \\ 
\hline 
2  &  3 & 1,10 & 2 & 2,20 \\ 
\hline 
3  &  4 & 1,39 & 4 & 5,56 \\ 
\hline 
4  &  5 & 1,61 & 2 & 3,22 \\ 
\hline 
5  &  6 & 1,79 & 4 & 7,16 \\ 
\hline 
6  &  7 & 1,95 & 2 & 3,90 \\ 
\hline 
7  &  8 & 2,08 & 4 & 8,32 \\ 
\hline 
8  &  9 & 2,20 & 2 & 4,40 \\ 
\hline 
9  & 10 & 2,30 & 4 & 9,20 \\ 
\hline 
10 & 11 & 2,40 & 2 & 4,80 \\ 
\hline 
11 & 12 & 2,48 & 4 & 9,92 \\ 
\hline 
12 & 13 & 2,56 & 1 & 2,56 \\ 
\hline 
\end{tabular}
\end{center}
\medskip
Somando os resultados da última coluna, e substituindo, resulta:
$I = \frac{1}{3} \cdot 64 = 21,33$.

\Exercise[title={3,0}]
Em relação às soluções aproximadas do problema de valor inicial
\[
\begin{cases}
y^\prime(x) = y(x)-x, \quad x \in [0,000, \ 1,500]\\
y(0,000) = 0,100
\end{cases}
\]
pelos métodos de Euler explícito e implícito, com passo $h=0,500$, verifique se é correto afirmar que o maior erro absoluto em ambos os casos ocorre quando $x = 1,500$, considerando que a solução exata é $y(x) = -\frac{9}{10} e^x + x + 1$.

{\color{blue} \textit{(Utilize números decimais com 3 dígitos após a vírgula)}}
\Answer
Denotando $f(x,y) = y-x$ e $h=0,5$, pode-se expressar a fórmula do método de Euler explícito da seguinte forma:
\[
y_n
= y_{n-1} + h f(x_{n-1}, y_{n-1})
= y_{n-1} + 0,5( y_{n-1} - x_{n-1} )
= 1,5 y_{n-1} - 0,5 x_{n-1}.
\]
Disto resulta que os valores obtidos a cada passo são os seguintes:
\medskip
\begin{center}
\begin{tabular}{|c|c|r|r|c|}
\hline
$n$ & $x_n$ & $y_n= 1,5 y_{n-1} - 0,5 x_{n-1}$ & $y_{exato}(x_n)$ & $\varepsilon_n = y_n-y_{exato}(x_n)$ \\ \hline\hline
$0$ & $0,000$ & $0,100$ & $0,100$ & $0,000$ \\ \hline
$1$ & $0,500$ & $1,5 \cdot 0,100 - 0,5 \cdot 0,000 =  0,150$ & $ 0,016$ & $0,134$ \\ \hline
$2$ & $1,000$ & $1,5 \cdot 0,016 - 0,5 \cdot 0,500 = -0,025$ & $-0,446$ & $0,421$ \\ \hline
$3$ & $1,500$ & $1,5 \cdot(-0,446)-0,5 \cdot 1,000 = -0,538$ & $-1,534$ & $\textbf{0,996}$ \\ \hline
\end{tabular}
\end{center}
\medskip
Em particular, o maior erro absoluto ocorre no ponto $x = 1,5$.

No método de Euler implícito, por sua vez, utiliza-se a relação $y_n = y_{n-1} + h f(x_n, y_n)$ que, no problema considerado, pode ser reescrita  de forma equivalente como:
\[
y_n
= y_{n-1} + 0,5( y_n - x_n )
\Leftrightarrow
0,5y_n = y_{n-1} - 0,5x_n
\Leftrightarrow
y_n = 2y_{n-1} - x_n.
\]
Consequentemente, os valores obtidos a cada passo são:
\medskip
\begin{center}
\begin{tabular}{|c|c|r|r|c|}
\hline
$n$ & $x_n$ & $y_n= 2 y_{n-1} - x_n$ & $y_{exato}(x_n)$ & $\varepsilon_n = y_n-y_{exato}(x_n)$ \\ \hline\hline
$0$ & $0,000$ & $0,100$ & $0,100$ & $0,000$ \\ \hline
$1$ & $0,500$ & $2 \cdot 0,100 - 0,500 =  0,300$ & $ 0,016$ & $-0,316$ \\ \hline
$2$ & $1,000$ & $2 \cdot(-0,300) - 1,000 = -1,600$ & $-0,446$ & $-1,154$ \\ \hline
$3$ & $1,500$ & $2 \cdot(-1,600)- 1,500 = -4,700$ & $-1,534$ & $\textbf{-3,166}$ \\ \hline
\end{tabular}
\end{center}
\medskip
Novamente, o maior erro absoluto (em módulo) ocorre no ponto $x = 1,5$.
\end{ExerciseList}

\vspace{0.4cm}
\begin{center}
BOA PROVA E BOAS FÉRIAS!
\end{center}

\newpage
\restoregeometry
\section*{Respostas}
\shipoutAnswer
\end{document}
