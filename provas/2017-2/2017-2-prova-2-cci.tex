\documentclass[12pt,a4paper]{article}
\usepackage{cmap} % Makes the PDF copiable. See http://tex.stackexchange.com/a/64198/25761
\usepackage[T1]{fontenc}
\usepackage[brazil]{babel}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{textcomp} % \degree
\usepackage{gensymb} % \degree
\usepackage[usenames,svgnames,dvipsnames]{xcolor}
\usepackage{hyperref}
\usepackage{multicol}
\usepackage{graphicx}
\usepackage[margin=2cm]{geometry}
\usepackage{systeme}

\hypersetup{
    colorlinks = true,
    allcolors = {blue}
}

% TODO: Consider using exsheets
% http://linorg.usp.br/CTAN/macros/latex/contrib/exsheets/exsheets_en.pdf
%
% http://ctan.org/tex-archive/macros/latex/contrib/exercise/
% Options: answerdelayed,lastexercise,noanswer
\usepackage[answerdelayed,lastexercise]{exercise}

\addto\captionsbrazil{%
\def\listexercisename{Lista de exerc\'icios}%
\def\ExerciseName{Exerc\'icio}%
\def\AnswerName{Solu\c{c}\~ao do exerc\'icio}%
\def\ExerciseListName{Ex.}%
\def\AnswerListName{Solu\c{c}\~ao}%
\def\ExePartName{Parte}%
\def\ArticleOf{de\ }%
}

\renewcommand{\ExerciseHeaderTitle}{(\ExerciseTitle)\ }
\renewcommand{\ExerciseListHeader}{%\ExerciseHeaderDifficulty%
\textbf{%\ExerciseListName\
\ExerciseHeaderNB.\ %
%\ --- \ 
\ExerciseHeaderTitle}%
%\ExerciseHeaderOrigin
\ignorespaces}
\renewcommand{\AnswerListHeader}{\textbf{\ExerciseHeaderNB.\ (\AnswerListName)\ }}

\renewcommand{\theenumi}{\alph{enumi}}
\renewcommand\labelenumi{(\theenumi) }

\newcommand*\tipo{Prova II}
\newcommand*\turma{CCI122-03U}
\newcommand*\disciplina{ANN0001}
\newcommand*\eu{Helder G. G. de Lima}
\newcommand*\data{19/10/2017}

\author{\eu}
\title{\tipo - \disciplina}
\date{\data}

\begin{document}
\thispagestyle{empty}
\newgeometry{margin=2cm,bottom=0.5cm}
\begin{center}
\includegraphics[width=9.0cm]{marca} \\
\textbf{\tipo\ (\disciplina / \turma)} \\
Prof. \eu\footnote{
Este é um material de acesso livre distribuído sob os termos da licença \href{https://creativecommons.org/licenses/by-sa/4.0/deed.pt_BR}{Creative Commons Atribuição-CompartilhaIgual 4.0 Internacional}}
\end{center}

\noindent Nome do(a) aluno(a): \underline{\hspace{9,7cm}} Data: \underline{\data}

%\section*{Instruções}
\begin{center}\fbox{
\begin{minipage}{14cm}

{\footnotesize
\begin{itemize}
\renewcommand{\theenumi}{\Roman{enumi}}
\item Identifique-se em todas as folhas.
\item Mantenha o celular e os demais equipamentos eletrônicos desligados durante a prova.
\item Justifique cada resposta com cálculos ou argumentos baseados na teoria estudada.
\item Ao escrever números decimais, arredonde-os com 4 casas depois da vírgula.
\item Resolva apenas os itens de que precisar para somar 10,0 pontos.
\end{itemize}
}

\end{minipage}
}
\end{center}

%\section*{Questões}
\begin{ExerciseList}
\Exercise[title={2,5}]
Resolva os sistemas lineares a seguir utilizando a fatoração $A = LU$:
\begin{multicols}{2}
\begin{enumerate}
\item \systeme{
 2x_1 +  x_2               = -5,
 6x_1 + 4x_2 + 2x_3        = -6, 
               2x_3 + x_4  =  9,
      -  x_2 - 2x_3 + x_4  = -8.
}
\item \systeme{
 2x_1 +  x_2               = -2,
 6x_1 + 4x_2 + 2x_3        =  0,
               2x_3 + x_4  =  6,
      -  x_2 - 2x_3 + x_4  = -4.
}
\end{enumerate}
\end{multicols}
\Answer
Através das operações $L_2 \to L_2 + 3L_1$ e $L_4 \to L_4 - L_2$, obtém-se $A = LU$, sendo
\[
L = \begin{bmatrix}
1 &  0 & 0 & 0\\
3 &  1 & 0 & 0\\
0 &  0 & 1 & 0\\
0 & -1 & 0 & 1
\end{bmatrix}
\text{ e }
U = \begin{bmatrix}
2 & 1 & 0 &  0\\
0 & 1 & 2 &  0\\
0 & 0 & 2 &  1\\
0 & 0 & 0 &  1
\end{bmatrix}.
\]

Como $A$ é a matriz de coeficientes de ambos os sistemas, pode-se usar a mesma fatoração nos dois casos. Para isso, resolve-se primeiramente um sistema $LY=B$ e com a solução $Y$ obtida resolve-se $UX = Y$. Os resultados em cada caso serão os seguintes:
\begin{multicols}{2}
\begin{enumerate}
\item
$
Y = \begin{bmatrix}
-5 \\ 9 \\9 \\ 1
\end{bmatrix}
\text{ e }
X = \begin{bmatrix}
-3 \\ 1 \\ 4 \\ 1
\end{bmatrix}
$
\item
$
Y  =
\begin{bmatrix}
-2 \\ 6 \\ 6 \\ 2
\end{bmatrix}
\text{ e }
 X  =
\begin{bmatrix}
-2 \\ 2 \\ 2 \\ 2
\end{bmatrix}$
\end{enumerate}
\end{multicols}

\Exercise[title={5,0}]
Sabe-se que $X^{(0)} = (1,1,1)$ está ``próximo'' da solução de $
\systeme{
  x_1 + 9x_2 +  x_3 = 10,
       -4x_2 + 8x_3 = 10,
10x_1        +  x_3 = 10.
}
$

Mostre que a aproximação $X^{(3)} = (x_1^{(3)}, x_2^{(3)}, x_3^{(3)})$ obtida pelo método de Jacobi tem um erro relativo que é cerca de 10 vezes o que é cometido ao usar o método de Gauss-Seidel. Permute as equações, caso isso torne mais fácil garantir que os métodos geram sequências convergentes.
\Answer A matriz de coeficientes do sistema linear em questão não é  estritamente diagonal dominante, pois na primeira linha tem-se  $|1| < |9| + |1|$. Então, por este critério, não há garantia de que os métodos iterativos convergirão. No entanto, pode-se permutar as linhas para obter
\[
\systeme{
10x_1        +  x_3 = 10,
  x_1 + 9x_2 +  x_3 = 10,
       -4x_2 + 8x_3 = 10
}
\Leftrightarrow
\begin{bmatrix}
10 &  0 & 1 \\
 1 &  9 & 1 \\
 0 & -4 & 8 \\
\end{bmatrix}
\cdot
\begin{bmatrix}
x_1 \\ x_2 \\ x_3
\end{bmatrix}
=
\begin{bmatrix}
10 \\ 10 \\ 10
\end{bmatrix}.
\]
Neste caso a matriz é estritamente diagonal dominante e há garantia de convergência. As equações utilizadas em cada um dos métodos iterativos são as seguintes:

\medskip
\begin{center}
\begin{tabular}{ll}
\textbf{Método de Jacobi}
&
\textbf{Método de Gauss-Seidel}\\ 
$
\begin{cases}
x_1^{(k)} = (10 - x_3^{(k-1)})/10\\
x_2^{(k)} = (10 - x_1^{ \boldsymbol{(k-1)} } - x_3^{(k-1)})/9\\
x_3^{(k)} = (10 + 4x_2^{ \boldsymbol{(k-1)} })/8,
\end{cases}
$
&
$
\begin{cases}
x_1^{(k)} = (10 - x_3^{(k-1)})/10\\
x_2^{(k)} = (10 - x_1^{ \boldsymbol{(k)} } - x_3^{(k-1)})/9\\
x_3^{(k)} = (10 + 4x_2^{ \boldsymbol{(k)} })/8.
\end{cases}
$\\
\end{tabular}
\end{center}
\medskip
Observe que no método de Gauss-Seidel, os valores de $x_j^{(k)}$ são utilizados em vez de $x_j^{(k-1)}$ assim que estão disponíveis. Consequentemente, os valores obtidos a cada iteração são os seguintes:
\medskip
\begin{center}
\begin{tabular}{cc}
\textbf{Método de Jacobi}
&
\textbf{Método de Gauss-Seidel}\\ 
\begin{tabular}{|c|r|r|r|r|}
\hline
$\boldsymbol{k}$     & 0 & 1 & 2 & 3 \\
\hline
$\boldsymbol{x_1^{(k)}}$ & 1.0000 & 0.9000 & 0.8250 & 0.8306\\
\hline
$\boldsymbol{x_2^{(k)}}$ & 1.0000 & 0.8889 & 0.8167 & 0.8312\\
\hline
$\boldsymbol{x_3^{(k)}}$ & 1.0000 & 1.7500 & 1.6944 & 1.6583\\
\hline
\end{tabular}
&
\begin{tabular}{|c|r|r|r|r|}
\hline
$\boldsymbol{k}$     & 0 & 1 & 2 & 3 \\
\hline
$\boldsymbol{x_1^{(k)}}$ & 1.0000 & 0.9000 & 0.8300 & 0.8335\\
\hline
$\boldsymbol{x_2^{(k)}}$ & 1.0000 & 0.9000 & 0.8300 & 0.8335\\
\hline
$\boldsymbol{x_3^{(k)}}$ & 1.0000 & 1.7000 & 1.6650 & 1.6668\\
\hline
\end{tabular}\\
\end{tabular}
\end{center}
\medskip
Na terceira iteração, obtêm-se as seguintes estimativas para os erros cometidos:
\medskip
\begin{center}
\begin{tabular}{|c|p{7.1cm}|p{7.1cm}|}
\hline
\textbf{Erro}
&
\textbf{Método de Jacobi}
&
\textbf{Método de Gauss-Seidel}\\\hline
Absoluto
&
$\begin{array}{lll}
       & ||X^{(3)} - X^{(2)}|| \\
= \max & \left\{\right. |0.8306-0.8250|, \\
       & \quad |0.8312-0.8167|, \\
       & \quad |1.6583-1.6944| \left.\right\} \\
= \max & \left\{ |0.0056|, |0.0145|, |-0.0361| \right\} \\
= 0.0361\hspace{-1cm} & 
\end{array}$
&
$\begin{array}{lll}
       & ||X^{(3)} - X^{(2)}|| \\
= \max & \left\{\right. |0.8335-0.8300|, \\
       & \quad |0.8335-0.8300|, \\
       & \quad |1.6668-1.6650| \left.\right\} \\
= \max & \left\{ |0.0035|, |0.0035|, |0.0018| \right\} \\
= 0.0035\hspace{-1cm} & 
\end{array}$
\\\hline
Relativo
&
$0.0361/1.6583 = 0.0218$
&
$0.0035/1.6668 = 0.0021$
\\\hline
\end{tabular}
\end{center}

\Exercise[title={2,5}]
Seja $f(x) = \cos\left(\dfrac{ \pi x }{2} \right)$. Usando o método de Lagrange, qual dos seguintes polinômios fornece um valor $p(1/2) \approx f(1/2) = \sqrt{2}/2$ com o menor erro absoluto?
\begin{enumerate}
\item O polinômio $p(x)$, que interpola $f$ nos pontos $x_1 = -1$, $x_2 = 0$ e $x_3 = 1$
\item O polinômio $q(x)$, que interpola $f$ nos pontos $x_1 = 0$, $x_2 = 1$ e $x_3 = 2$
\end{enumerate}
\Answer \begin{enumerate}
\item Considerando $x_1 = -1$,  $x_2 = 0$, $x_3 = 1$ e $y_1 = 0$, $y_2 = 1$ e $y_3 = 0$, tem-se:
\[
p(x)
= 0 L_1(x) + 1 L_2(x) + 0 L_3(x)
= \frac{(x+1)(x-1)}{(0+1)(0-1)}
= 1-x^2.
\]
Logo, o erro absoluto em $x = 1/2$ é dado por
\[
\varepsilon_{abs}
= |f(1/2) - p(1/2)|
\approx |0.7071 - 0.7500|
= |-0.0429| = 0.0429.
\]
\item Considerando $x_1 = 0$, $x_2 = 1$,  $x_3 =  2$ e
                   $y_1 = 1$, $y_2 = 0$ e $y_3 = -1$, tem-se:
\begin{align*}
q(x)
& = 1L_1(x) + 0L_2(x) - 1L_3(x) 
  = \frac{(x - 1)(x - 2)}{(-1)(-2)}
  - \frac{(x - 0)(x - 1) }{(2-0)(2-1)}\\
&  = \frac{1}{2}(x - 1)(x - 2) - \frac{1}{2} x(x - 1)
   = 1 - x.
\end{align*}
Logo, o erro absoluto em $x = 3$ é dado por
\[
\varepsilon_{abs}
= |f(1/2) - q(1/2)|
\approx |0.7071 - 0.5000|
= 0.2071.
\]
\end{enumerate}
Portanto, o valor de $f(1/2)$ está mais próximo de $p(1/2)$ do que de $q(1/2)$.

\Exercise[title={2,5}]
A tabela a seguir mostra como o desempenho de um processador (fictício) varia conforme o tempo que ele fica superaquecido:
\begin{center}
\begin{tabular}{ p{3cm}|p{3.5cm}}
\hline			
\textbf{ \% de tempo \newline superaquecido}
& \textbf{Frequência (MHz)} \\ \hline\hline
 0 & 3500 \\ \hline
10 & 3400 \\ \hline
60 & 2500 \\ \hline
90 & 1500 \\ \hline
\end{tabular}
\end{center}

Utilize diferenças divididas para encontrar um polinômio interpolador $p(x)$ e utilize-o para estimar qual seria a frequência do processador caso ele ficasse 50\% do tempo superaquecido.
\Answer
 A partir dos pontos dados, obtém-se:
\[
	\begin{array}{cccccc}
   x_i & y_i=f[x_i] & f[x_i,x_{i+1}] & f[x_i,x_{i+1},x_{i+2}]  & f[x_i,x_{i+1},x_{i+2},x_{i+3}] \\
     0 & \mathbf{3500} \\
	    &            & \mathbf{-10} \\
    10 & 3400 &             & \mathbf{-\frac{2}{15} \approx -0.1333} \\
	    &            & -18  &              & \mathbf{-\frac{7}{10800} \approx -0.0006}. \\
	60 & 2500 &             & -\frac{23}{120} \approx -0.1917\\
	    &            & -\frac{100}{3} \approx -33.3333 \\
	90 & 1500
	\end{array}
\]

Então:
\begin{align*}
p(x)
&=3500
 -10 x
 -0.1333 x(x-10)
 -0.0006 x(x-10)(x-60)\\
& = -0.0006 x^3 - 0.0913 x^2 - 9.027 x + 3500.
\end{align*}
Usando este polinômio para estimar o valor pedido, resulta que:
\[
p(50)
=3500 -10
  \cdot 50
-0.1333\cdot 50 \cdot 40
-0.0006\cdot 50 \cdot 40\cdot(-10)
= 2745.4.
\]
\end{ExerciseList}

\vspace{0.4cm}
\begin{center}
BOA PROVA!
\end{center}

\newpage
\restoregeometry
\section*{Respostas}
\shipoutAnswer
\end{document}
